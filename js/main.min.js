function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _callSuper(t,e,n){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,n||[],_getPrototypeOf(t).constructor):e.apply(t,n))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function _defineProperty(t,e,n){return(e=_toPropertyKey(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,_toPropertyKey(o.key),o)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){t=_toPrimitive(t,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===e?String:Number)(t);n=n.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}function _classPrivateFieldInitSpec(t,e,n){_checkPrivateRedeclaration(t,e),e.set(t,n)}function _checkPrivateRedeclaration(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet(t,e){return t.get(_assertClassBrand(t,e))}function _classPrivateFieldSet(t,e,n){return t.set(_assertClassBrand(t,e),n),n}function _assertClassBrand(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}import{nanoid}from"https://cdn.jsdelivr.net/npm/nanoid/nanoid.js";var body=document.body,mobilePopup=document.querySelector(".mobile-popup"),form=document.querySelector(".form"),containerWorkouts=document.querySelector(".workouts"),inputType=document.querySelector(".form__input--type"),inputDistance=document.querySelector(".form__input--distance"),inputDuration=document.querySelector(".form__input--duration"),inputCadence=document.querySelector(".form__input--temp"),inputElevation=document.querySelector(".form__input--climb"),sidebar=document.querySelector(".sidebar"),btnTrash=document.querySelector(".btn--trash"),mapContainerById=document.querySelector("#map"),btnBack=document.querySelector(".btn-back"),_mapEvent=new WeakMap,_map=new WeakMap,_workouts=new WeakMap,App=(()=>_createClass(function t(){_classCallCheck(this,t),_classPrivateFieldInitSpec(this,_mapEvent,void 0),_classPrivateFieldInitSpec(this,_map,void 0),_classPrivateFieldInitSpec(this,_workouts,[]),this.click=0,this.timeOut=0,this._getPosition(),form.addEventListener("submit",this._newWorkout.bind(this)),sidebar.addEventListener("click",this._hideWorkoutForm.bind(this)),inputType.addEventListener("change",this._toggleClimbField.bind(this)),containerWorkouts.addEventListener("click",this._moveToWorkout.bind(this)),this._getLocalStorageData(),btnTrash.addEventListener("click",this._deleteAllWorkouts.bind(this)),btnBack.addEventListener("click",this._hideWorkoutFormMobile.bind(this))},[{key:"_getPosition",value:function(){navigator.geolocation?navigator.geolocation.getCurrentPosition(this._loadMap.bind(this)):alert("–í–∞—à–∞ –≥–µ–æ–ª–æ–∫–∞—Ü–∏—è –Ω–µ —Å–º–æ–≥–ª–∞ –±—ã—Ç—å –∑–∞–≥—Ä—É–∂–µ–Ω–∞")}},{key:"_loadMap",value:function(t){var e=this,t=t.coords,n=t.latitude,t=t.longitude;_classPrivateFieldSet(_map,this,L.map("map").setView([n,t],13)),L.tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(_classPrivateFieldGet(_map,this)),_classPrivateFieldGet(_map,this).on("click",this._showForm.bind(this)),_classPrivateFieldGet(_workouts,this).forEach(function(t){return e._showPoint(t)})}},{key:"_showForm",value:function(t){document.documentElement.scrollWidth<=719&&(mapContainerById.style.display="none",sidebar.style.display="flex",mobilePopup.style.display="none"),_classPrivateFieldSet(_mapEvent,this,t),form.classList.remove("hidden"),inputDistance.focus()}},{key:"_hideForm",value:function(){form.classList.add("hidden")}},{key:"_toggleClimbField",value:function(){inputCadence.parentElement.classList.toggle("form__row--hidden"),inputElevation.parentElement.classList.toggle("form__row--hidden")}},{key:"_newWorkout",value:function(t){t.preventDefault();function e(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.every(function(t){return Number.isFinite(t)})}function n(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.every(function(t){return 0<t})}var t=_classPrivateFieldGet(_mapEvent,this).latlng,o=t.lat,t=t.lng,i=inputType.value,r=+inputDistance.value,a=+inputDuration.value;if("running"===i){var s=+inputCadence.value;if(!e(r,a,s)||!n(r,a,s))return alert("–í–≤–µ–¥–∏—Ç–µ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–µ —á–∏—Å–ª–æ!");s=new Running(r,a,[o,t],s)}if("cycling"===i){i=+inputElevation.value;if(!e(r,a,i)||!n(r,a))return alert("–í–≤–µ–¥–∏—Ç–µ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–µ —á–∏—Å–ª–æ!");s=new Cycling(r,a,[o,t],i)}this._showPoint(s),_classPrivateFieldGet(_workouts,this).push(s),this._addWorkoutsToLocalStorage.call(this),this._displayWorkoutToSidebar(s),this._hideForm()}},{key:"_showPoint",value:function(t){inputDistance.value=inputDuration.value=inputCadence.value=inputElevation.value="",L.marker(t.coords).addTo(_classPrivateFieldGet(_map,this)).bindPopup(L.popup({content:"".concat("running"===t.type?"üèÉ":"üöµ‚Äç‚ôÇÔ∏è"," ").concat(t.date),maxWidth:110,maxHeight:30,autoClose:!1,className:"".concat(t.type,"-popup"),closeOnClick:!1})).openPopup()}},{key:"_displayWorkoutToSidebar",value:function(t){t='<li class="workout workout--running" data-id="'.concat(t._id,'">\n          <h2 class="workout__title">').concat("running"===t.type?"–ü—Ä–æ–±–µ–∂–∫–∞":"–í–µ–ª–æ—Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞"," ").concat(t.date,'</h2>\n          <div class="workout__details">\n            <span class="workout__icon">').concat("running"===t.type?"üèÉ":"üöµ‚Äç‚ôÇÔ∏è",'</span>\n            <span class="workout__value">').concat(+t.distance.toFixed(2),'</span>\n            <span class="workout__unit">–∫–º</span>\n          </div>\n          <div class="workout__details">\n            <span class="workout__icon">‚è±</span>\n            <span class="workout__value">').concat(Math.round(t.duration),'</span>\n            <span class="workout__unit">–º–∏–Ω</span>\n          </div>\n          <div class="workout__details">\n            <span class="workout__icon">üìè</span>\n            <span class="workout__value">').concat("running"===t.type?"".concat(+t.pace.toFixed(2)):"".concat(+t.speed.toFixed(2)),'</span>\n            <span class="workout__unit">').concat("running"===t.type?"–º–∏–Ω/–∫–º":"–∫–º/—á",'</span>\n          </div>\n          <div class="workout__details">\n            <span class="workout__icon">').concat("running"===t.type?"‚è±":"üèî",'</span>\n            <span class="workout__value">').concat("running"===t.type?"".concat(Math.round(t.temp)):"".concat(Math.round(t.climb)),'</span>\n            <span class="workout__unit">').concat("running"===t.type?"—à–∞–≥/–º–∏–Ω":"–º","</span>\n          </div>\n        </li>");form.insertAdjacentHTML("afterend",t)}},{key:"_moveToWorkout",value:function(t){var e=this,n=t.target.closest(".workout");n&&(this.click++,this.timeOut,1===this.click?this.timeOut=setTimeout(function(){var t=_classPrivateFieldGet(_workouts,e).find(function(t){return t._id==n.dataset.id});t.click(),_classPrivateFieldGet(_map,e).setView(t.coords,13,{animate:!0,pan:{duration:1}}),e.click=0},200):(this.click=0,clearTimeout(this.timeOut),this._deleteWorkout.call(this,t)))}},{key:"_addWorkoutsToLocalStorage",value:function(){localStorage.setItem("workouts",JSON.stringify(_classPrivateFieldGet(_workouts,this)))}},{key:"_getLocalStorageData",value:function(){var e=this,t=JSON.parse(localStorage.getItem("workouts"));t&&(t.forEach(function(t){"running"===t.type&&_classPrivateFieldGet(_workouts,e).push(new Running(t.distance,t.duration,t.coords,t.temp)),"cycling"===t.type&&_classPrivateFieldGet(_workouts,e).push(new Cycling(t.distance,t.duration,t.coords,t.climb))}),_classPrivateFieldGet(_workouts,this).forEach(function(t){return e._displayWorkoutToSidebar(t)}))}},{key:"_reset",value:function(){localStorage.removeItem("workouts")}},{key:"_deleteWorkout",value:function(t){var e=t.target.closest(".workout");e&&(t=_classPrivateFieldGet(_workouts,this).findIndex(function(t){return t._id==e.dataset.id}),_classPrivateFieldGet(_workouts,this).splice(t,1),this._reset(),e.remove(),this._addWorkoutsToLocalStorage(),location.reload())}},{key:"_deleteWorkoutPoint",value:function(t){}},{key:"_clearAll",value:function(t){t.forEach(function(t){return t.remove()})}},{key:"_hideWorkoutForm",value:function(t){document.documentElement.scrollWidth<=719||(t.target.classList.contains("sidebar")||t.target.classList.contains("workouts")||t.target.classList.contains("footer__copyright")||t.target.classList.contains("icon"))&&form.classList.add("hidden")}},{key:"_hideWorkoutFormMobile",value:function(t){mapContainerById.style.display="block",sidebar.style.display="none",mobilePopup.style.display="block"}},{key:"_deleteAllWorkouts",value:function(){this._reset(),location.reload()}}]))(),Workout=(()=>_createClass(function t(e,n,o){_classCallCheck(this,t),_defineProperty(this,"_id",nanoid()),_defineProperty(this,"clickNumber",0),this.distance=e,this.duration=n,this.coords=o,this.date=new Intl.DateTimeFormat("ru-RU").format(new Date)},[{key:"click",value:function(){this.clickNumber++}}]))(),Running=(()=>{function i(t,e,n,o){return _classCallCheck(this,i),_defineProperty(t=_callSuper(this,i,[t,e,n]),"type","running"),t.temp=o,t.calculatePace(),t}return _inherits(i,Workout),_createClass(i,[{key:"calculatePace",value:function(){this.pace=this.duration/this.distance}}])})(),Cycling=(()=>{function i(t,e,n,o){return _classCallCheck(this,i),_defineProperty(t=_callSuper(this,i,[t,e,n]),"type","cycling"),t.climb=o,t.calculateSpeed(),t}return _inherits(i,Workout),_createClass(i,[{key:"calculateSpeed",value:function(){this.speed=this.distance/(this.duration/60)}}])})(),app=new App;
//# sourceMappingURL=main.min.js.map
